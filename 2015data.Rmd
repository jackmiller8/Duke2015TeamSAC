---
title: "EDA"
output: html_document
---

```{r}
library(tidyverse)
library(knitr)
library(broom)
library(readxl)
```

```{r}
data2015 <- read_excel("Duke2015.xls", sheet = 1)
data2014 <- read_excel("Duke2015.xls", sheet = 3)
data2013 <- read_excel("Duke2015.xls", sheet = 4)
data2012 <- read_excel("Duke2015.xls", sheet = 5)
MM2015 <- read_excel("Duke2015.xls", sheet = 2)
```

```{r}
Min1415 <- merge(data2015, data2014, by = "Player", all.x = TRUE)
min <- Min1415 %>% 
  mutate_all(~replace(., is.na(.), 0)) %>% 
  mutate(total_min = MP.x + MP.y) %>% 
  select(Player, total_min)
Min1315 <- merge(min, data2013, by = "Player", all.x = TRUE)
min2 <- Min1315 %>% 
  mutate_all(~replace(., is.na(.), 0)) %>% 
  mutate(total_min = total_min + MP) %>% 
  select(Player, total_min)
Min1215 <- merge(min2, data2012, by = "Player", all.x = TRUE)
min3 <- Min1215 %>% 
  mutate_all(~replace(., is.na(.), 0)) %>% 
  mutate(total_min = total_min + MP) %>% 
  select(Player, total_min)
```

```{r}
data2015 <- merge(MM2015, data2015, by = "Player", all.x = TRUE, all.y = TRUE)
```

```{r}
colnames(data2015)[2] <- "total_min"
colnames(data2015)[3] <- "min_before_mm"
```


```{r}
data2015 <- data2015 %>% 
  mutate(role = case_when(
    min_before_mm > 1000 & (Class == "SR" | Class == "JR") ~ "ExpUp", 
    min_before_mm > 800 & (Class == "SO" | Class == "FR") ~ "ExpUn",
    TRUE ~ "Role"
  ))
```

